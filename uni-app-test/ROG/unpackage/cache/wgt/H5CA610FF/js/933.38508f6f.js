"use strict";(self["webpackChunkmuban"]=self["webpackChunkmuban"]||[]).push([[933],{2933:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"allDetail"},[s("van-popup",{model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("img",{attrs:{src:a(5890),alt:""}})]),s("div",{staticClass:"share"},[s("van-nav-bar",{attrs:{title:"商品详情","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),s("van-cell",{attrs:{title:"分享",icon:"share-o"},on:{click:function(e){t.showShare=!0}}}),s("van-share-sheet",{attrs:{title:"立即分享给好友",options:t.options},on:{select:t.onSelect},model:{value:t.showShare,callback:function(e){t.showShare=e},expression:"showShare"}})],1),s("div",{staticClass:"detail"},[s("img",{attrs:{src:t.detail.large_img,alt:""}})]),s("div",{staticClass:"all-detail"},[s("div",{staticClass:"name-detail"},[s("div",{staticClass:"detail-name"},[s("span",[t._v(t._s(t.detail.name))])]),s("div",{staticClass:"detail-price"},[s("span",[t._v("¥"+t._s(t.detail.price))])])]),s("div",{staticClass:"detail-enname"},[s("span",[t._v(t._s(t.detail.enname))])]),s("div",{staticClass:"put"},[s("span",[t._v("推荐指数：")]),t._v(" "),s("van-rate",{attrs:{icon:"smile","void-icon":"smile-o",readonly:""},model:{value:t.starvalue,callback:function(e){t.starvalue=e},expression:"starvalue"}})],1),s("div",{staticClass:"van-hairline--top"}),t._l(t.rules,(function(e,a){return s("div",{key:a,staticClass:"specs"},[s("div",{staticClass:"specs-detail"},[t._v(t._s(e.type))]),s("div",{staticClass:"choose-box"},t._l(e.choose,(function(a,o){return s("span",{key:o,staticClass:"spece-choose",class:{active:e.rulesIndex==o},on:{click:function(t){e.rulesIndex=o}}},[t._v(t._s(a))])})),0)])})),s("div",{staticClass:"van-hairline--top"}),s("div",{staticClass:"specs-detail"},[s("div",{staticClass:"num"},[s("span",[t._v("选择数量")]),s("div",{staticClass:"numCount"},[s("van-stepper",{attrs:{theme:"round",max:"8","button-size":"22"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)]),s("div",{staticClass:"van-hairline--top"})]),s("div",{staticClass:"text-detail"},[s("span",[t._v("商品描述")]),s("div",{staticClass:"desc"},t._l(t.desc,(function(e,a){return s("p",{key:a},[t._v(t._s(a+1)+"."+t._s(e))])})),0)])],2),s("van-goods-action",[s("van-goods-action-icon",{attrs:{icon:"bag-o",text:"购物袋",badge:0==t.bagCount?"":t.bagCount,color:t.bagCount>0?"#0c34ba":""},on:{click:t.toCar}}),s("van-goods-action-icon",{attrs:{icon:t.status?"like-o":"like",text:t.status?"未收藏":"已收藏",badge:t.l?t.l:""},on:{click:t.onClickIcon}}),s("van-goods-action-button",{attrs:{type:"warning",color:"#6a91ec",text:"加入购物袋"},on:{click:function(e){return t.addCar()}}}),s("van-goods-action-button",{attrs:{type:"danger",color:"#0c34ba",text:"立即购买"},on:{click:function(e){return t.onClickButton(!0)}}})],1)],1)},o=[],i=(a(4837),a(9146)),l=a(6194),n={data(){return{starvalue:Math.ceil(5*Math.random()),show:!1,showShare:!1,options:[[{name:"微信",icon:"wechat",message:"分享给微信好友",description:"你最常用的"},{name:"QQ",icon:"qq",message:"分享给QQ好友"},{name:"朋友圈",icon:"wechat-moments",message:"分享到朋友圈"},{name:"微博",icon:"weibo",message:"分享到微博"},{name:"复制链接",icon:"link",message:"链接已复制"},{name:"分享海报",icon:"poster",message:"海报已生成"}],[{name:"图片保存至本地",icon:"poster",message:"图片已保存到本地"},{name:"小程序码",icon:"weapp-qrcode",message:"分享到小程序"},{name:"二维码",icon:"qrcode"}]],bagCount:0,detail:{},rules:[],value:1,desc:[],status:!0,pid:"",l:""}},mixins:[l.a],created(){this.getDetail(this.$route.query.pid),this.pid=this.$route.query.pid,this.getMylike(),this.getProductstasus(),this.shopBagCount()},methods:{onSelect(t){"二维码"!=t.name?"微博"!=t.name?"微信"!=t.name?"QQ"!=t.name?((0,i.Z)(t.message),this.showShare=!1):window.location.href="https://im.qq.com/":window.location.href="https://weixin.qq.com/":window.location.href="https://www.weibo.com":this.show=!0},getMylike(){localStorage.getItem("_lk")&&this.axios({method:"get",url:"/findAllLike",params:{appkey:this.appkey,tokenString:localStorage.getItem("_lk")}}).then((t=>{console.log("查询成功",t),this.l=t.data.result.length}))},getProductstasus(){localStorage.getItem("_lk")&&this.axios({method:"get",url:"/findlike",params:{appkey:this.appkey,pid:this.pid,tokenString:localStorage.getItem("_lk")}}).then((t=>{console.log("查询收藏成功",t),0==t.data.result.length?this.status=!0:this.status=!1}))},onClickLeft(){this.$router.go(-1)},toCar(){localStorage.getItem("_lk")?this.$router.push({name:"Car"}):(0,i.Z)("请先登录！")},onClickIcon(){localStorage.getItem("_lk")?(this.status=!this.status,this.status?(this.axios({method:"post",url:"/notlike",data:{appkey:this.appkey,pid:this.pid,tokenString:localStorage.getItem("_lk")}}).then((t=>{console.log("取消收藏成功",t),this.l=this.l-1,0==this.l&&(this.l=!1)})),this.$toast({icon:"like-o",message:"已取消收藏",duration:1e3})):(this.axios({method:"post",url:"/like",data:{appkey:this.appkey,pid:this.pid,tokenString:localStorage.getItem("_lk")}}).then((t=>{console.log("加入收藏成功",t),this.l+=1})),this.$toast({icon:"like",message:"已加入收藏",duration:1e3}))):(0,i.Z)("请先登录！")},addCar(t){if(!localStorage.getItem("_lk"))return this.$toast("请登录！"),void this.$router.push({name:"Login"});let e=this.rules.map((t=>t.choose[t.rulesIndex]));this.axios({method:"post",url:"/addShopcart",data:{rule:e.join("/"),pid:this.pid,count:this.value,appkey:this.appkey,tokenString:localStorage.getItem("_lk")}}).then((e=>{console.log("加入购物车成功",e),3e3==e.data.code?(this.$toast("加入购物车成功"),t?this.$router.push({name:"Pay",query:{sids:e.data.sid}}):1==e.data.status&&this.bagCount++):this.$toast("加入购物车失败")})).catch((t=>{console.log(t)}))},onClickButton(t){this.addCar(t)},getDetail(t){this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"get",url:"/productDetail",params:{appkey:this.appkey,pid:t}}).then((t=>{this.$toast.clear(),console.log("请求成功的产品详情",t),this.detail=t.data.result[0],this.desc=t.data.result[0].desc.split(/\n/);let e=t.data.result[0],a=["cream","milk","sugar","tem"];a.map((t=>{let a={choose:[],rulesIndex:0};a.type=e[t+"_desc"];let s=e[t].split("/");s.map((t=>{""!=t&&a.choose.push(t)})),a.choose.length>0&&this.rules.push(a)}))})).catch((t=>{console.log("请求失败",t)}))}}},c=n,r=a(3736),h=(0,r.Z)(c,s,o,!1,null,null,null),d=h.exports},6194:function(t,e,a){a.d(e,{a:function(){return s}});const s={methods:{shopBagCount(){let t=localStorage.getItem("_lk");t&&(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/shopcartRows",params:{appkey:this.appkey,tokenString:t}}).then((t=>{this.$toast.clear(),8e3==t.data.code&&(this.bagCount=t.data.result)})).catch((t=>{this.$toast.clear()})))}}}},5890:function(t,e,a){t.exports=a.p+"img/Code.146cf105.png"}}]);
//# sourceMappingURL=933.38508f6f.js.map