(self["webpackChunkmuban"]=self["webpackChunkmuban"]||[]).push([[743],{2742:function(t,e,s){"use strict";s.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-item"},[s("div",{staticClass:"cell-item-box"},[s("div",{staticClass:"pro-info-box"},[s("div",{staticClass:"fl pro-img"},[s("img",{staticClass:"auto-img",attrs:{src:t.item.small_img||t.item.smallImg,alt:""}})]),s("div",{staticClass:"fl pro-info"},[s("div",{staticClass:"pro-info-text"},[s("div",{staticClass:"clearfix names"},[s("div",{staticClass:"fl pro-name"},[t._v(t._s(t.item.name))]),s("div",{staticClass:"fl pro-rule"},[t._v("规格："+t._s(t.item.rule))])]),s("div",{staticClass:"pro-enname"},[t._v(t._s(t.item.enname))])]),s("div",{staticClass:"pro-count-box"},[s("div",{staticClass:"fl pro-price"},[t._v("￥"+t._s(t.item.price))]),s("div",{staticClass:"fr step-box"},[t._v("x"+t._s(t.item.count))])])])])])])},r=[],n={name:"OrderItem",props:{item:{type:Object,default(){return{name:"名称",rule:"规格",enname:"英文名称",price:0,count:1}}}}},a=n,o=s(3736),d=(0,o.Z)(a,i,r,!1,null,"623aef45",null),c=d.exports},7342:function(t,e,s){"use strict";s.d(e,{Z:function(){return l}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-list"},[s("div",{staticClass:"pro-box"},[s("div",{staticClass:"clearfix info-boxs"},[s("div",{staticClass:"info-title fl"},[t._v("订单编号："+t._s(t.infoTitleLeft))]),t.isRight?s("div",{staticClass:"fr re-info"},[t.isReceive?s("div",{staticClass:"clearfix"},[s("div",{staticClass:"fl"},[t._v("已完成")]),s("div",{staticClass:"fl delete",on:{click:t.remove}},[s("van-icon",{attrs:{size:"19",name:"delete"}})],1)]):s("div",{staticStyle:{color:"#fc5531"},on:{click:t.confirmReceive}},[t._v("确认收货")])]):t._e()]),s("div",[s("div",{staticClass:"cell-list"},[t._t("default")],2),s("div",{staticClass:"bottom-into"},[t._m(0),""!=t.date?s("div",{staticClass:"date"},[t._v("下单时间："+t._s(t.date))]):t._e(),s("div",{staticClass:"clearfix"},[s("div",{staticClass:"fl"},[t._v("共计 "+t._s(t.count)+" 件")]),s("div",{staticClass:"fr total"},[t._v("合计 ￥"+t._s(t.total))])])])])])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"circle"},[s("div",{staticClass:"fl circle-box circle-left"}),s("div",{staticClass:"fr circle-box circle-right"})])}],n=s(6143),a=s.n(n),o={name:"OrderList",props:{infoTitleLeft:{type:String,default:"左边标题"},isRight:{type:Boolean,default:!1},date:{type:String,default:a()(Date.now()).format("YYYY-MM-DD HH:mm:ss")},count:{type:Number,default:0},total:{type:[Number,String],default:0},isReceive:{type:Boolean,default:!1}},methods:{confirmReceive(){this.$emit("confirm-receive")},remove(){this.$emit("remove")}}},d=o,c=s(3736),u=(0,c.Z)(d,i,r,!1,null,"c3d9e9f2",null),l=u.exports},5743:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return l}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pay"},[s("van-nav-bar",{attrs:{title:"订单结算","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":t.back}}),s("div",{staticClass:"pay-box"},[s("div",{staticClass:"select-address"},[s("div",[s("span",{staticStyle:{"font-weight":"1000",color:"orange"},on:{click:t.showSelectAddressList}},[t._v("选择地址")]),s("van-icon",{staticClass:"arrow",attrs:{name:"arrow"}})],1),s("div",{staticClass:"user-box"},[s("div",{staticClass:"user-info"},[s("div",{staticClass:"user-name"},[t._v("收件人："+t._s(t.currentAddress.name?t.currentAddress.name:"无"))]),s("div",{staticClass:"user-phone"},[t._v("电话："+t._s(t.currentAddress.tel?t.currentAddress.tel:"无"))]),t.currentAddress.isDefault?s("div",{staticClass:"default-address"},[t._v("默认")]):t._e()]),s("div",{staticClass:"detail-address"},[t._v("详细地址："+t._s(t.currentAddress.address?t.currentAddress.address:"无"))])])]),s("div",{staticClass:"order-info"},[s("OrderList",{attrs:{"info-title-left":"订单信息",count:t.productInfo.count,total:t.productInfo.total}},t._l(t.products,(function(t,e){return s("OrderItem",{key:e,attrs:{item:t}})})),1)],1)]),s("div",{staticClass:"btn-box"},[s("van-button",{attrs:{type:"primary",block:"",round:"",color:"#0c34ba"},on:{click:t.payBox}},[t._v("立即结算")])],1),s("van-popup",{attrs:{"is-link":"",position:"bottom",closeable:""},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[s("div",{staticClass:"address-title"},[t._v("选择地址")]),s("van-address-list",{attrs:{list:t.list,"default-tag-text":"默认"},on:{add:t.newAddress,edit:t.edit,select:t.selectAddress},model:{value:t.chosenAddressId,callback:function(e){t.chosenAddressId=e},expression:"chosenAddressId"}})],1)],1)},r=[],n=s(7342),a=s(2742),o={name:"Pay",components:{OrderList:n.Z,OrderItem:a.Z},data(){return{isOpen:!1,chosenAddressId:"",list:[],currentAddress:{},sids:[],products:[],productInfo:{count:0,total:0}}},created(){this.sids=this.$route.query.sids.split("-"),this.getShopbagBySids(),this.getAddressData()},methods:{back(){this.$router.go(-1)},newAddress(){this.$router.push({name:"NewAddress"})},selectAddress(t,e){this.isOpen=!1,this.currentAddress=t},showSelectAddressList(){this.isOpen=!0},getAddressData(){let t=localStorage.getItem("_lk");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/findAddress",params:{appkey:this.appkey,tokenString:t}}).then((t=>{this.$toast.clear(),700==t.data.code?this.$router.push({name:"Login"}):2e4==t.data.code&&(t.data.result.map((t=>{t.isDefault=Boolean(t.isDefault),t.id=t.aid,t.address=`${t.province}${t.city}${t.county}${t.addressDetail}`,t.isDefault&&(this.chosenAddressId=t.aid,this.currentAddress=t)})),this.list=t.data.result)})).catch((t=>{this.$toast.clear()}))},getShopbagBySids(){let t=localStorage.getItem("_lk");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/commitShopcart",params:{appkey:this.appkey,tokenString:t,sids:JSON.stringify(this.sids)}}).then((t=>{if(this.$toast.clear(),700==t.data.code)this.$router.push({name:"Login"});else if(5e4==t.data.code){if(0==t.data.result.length)return this.$router.push({name:"Home"});t.data.result.map((t=>{this.productInfo.count+=t.count,this.productInfo.total+=t.count*t.price})),this.products=t.data.result}else this.$toast(t.data.msg)})).catch((t=>{this.$toast.clear()}))},edit(t){this.$router.push({name:"NewAddress",query:{aid:t.aid}})},pay(){let t=localStorage.getItem("_lk");if(!t)return this.$toast("请先登录"),this.$router.push({name:"Login"});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/pay",data:{appkey:this.appkey,tokenString:t,sids:JSON.stringify(this.sids),phone:this.currentAddress.tel,address:this.currentAddress.address,receiver:this.currentAddress.name}}).then((t=>{this.$toast.clear(),700==t.data.code?this.$router.push({name:"Login"}):(this.$toast(t.data.msg),setTimeout((()=>{this.$router.push({name:"Order"})})))})).catch((t=>{this.$toast.clear()}))},payBox(){this.chosenAddressId?this.$dialog.confirm({title:"确认订单",message:"是否立即结算?",confirmButtonColor:"#0c34ba"}).then((()=>{this.pay()})).catch((t=>{})):this.$toast("请选择收货地址")}}},d=o,c=s(3736),u=(0,c.Z)(d,i,r,!1,null,null,null),l=u.exports},6143:function(t){!function(e,s){t.exports=s()}(0,(function(){"use strict";var t=1e3,e=6e4,s=36e5,i="millisecond",r="second",n="minute",a="hour",o="day",d="week",c="month",u="quarter",l="year",h="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},$=function(t,e,s){var i=String(t);return!i||i.length>=e?t:""+Array(e+1-i.length).join(s)+t},g={s:$,z:function(t){var e=-t.utcOffset(),s=Math.abs(e),i=Math.floor(s/60),r=s%60;return(e<=0?"+":"-")+$(i,2,"0")+":"+$(r,2,"0")},m:function t(e,s){if(e.date()<s.date())return-t(s,e);var i=12*(s.year()-e.year())+(s.month()-e.month()),r=e.clone().add(i,c),n=s-r<0,a=e.clone().add(i+(n?-1:1),c);return+(-(i+(s-r)/(n?r-a:a-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:l,w:d,d:o,D:h,h:a,m:n,s:r,ms:i,Q:u}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},y="en",_={};_[y]=p;var C=function(t){return t instanceof M},S=function t(e,s,i){var r;if(!e)return y;if("string"==typeof e){var n=e.toLowerCase();_[n]&&(r=n),s&&(_[n]=s,r=n);var a=e.split("-");if(!r&&a.length>1)return t(a[0])}else{var o=e.name;_[o]=e,r=o}return!i&&r&&(y=r),r||!i&&y},D=function(t,e){if(C(t))return t.clone();var s="object"==typeof e?e:{};return s.date=t,s.args=arguments,new M(s)},b=g;b.l=S,b.i=C,b.w=function(t,e){return D(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var M=function(){function p(t){this.$L=S(t.locale,null,!0),this.parse(t)}var $=p.prototype;return $.parse=function(t){this.$d=function(t){var e=t.date,s=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var i=e.match(m);if(i){var r=i[2]-1||0,n=(i[7]||"0").substring(0,3);return s?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,n)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,n)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},$.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},$.$utils=function(){return b},$.isValid=function(){return!(this.$d.toString()===f)},$.isSame=function(t,e){var s=D(t);return this.startOf(e)<=s&&s<=this.endOf(e)},$.isAfter=function(t,e){return D(t)<this.startOf(e)},$.isBefore=function(t,e){return this.endOf(e)<D(t)},$.$g=function(t,e,s){return b.u(t)?this[e]:this.set(s,t)},$.unix=function(){return Math.floor(this.valueOf()/1e3)},$.valueOf=function(){return this.$d.getTime()},$.startOf=function(t,e){var s=this,i=!!b.u(e)||e,u=b.p(t),f=function(t,e){var r=b.w(s.$u?Date.UTC(s.$y,e,t):new Date(s.$y,e,t),s);return i?r:r.endOf(o)},m=function(t,e){return b.w(s.toDate()[t].apply(s.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(e)),s)},v=this.$W,p=this.$M,$=this.$D,g="set"+(this.$u?"UTC":"");switch(u){case l:return i?f(1,0):f(31,11);case c:return i?f(1,p):f(0,p+1);case d:var y=this.$locale().weekStart||0,_=(v<y?v+7:v)-y;return f(i?$-_:$+(6-_),p);case o:case h:return m(g+"Hours",0);case a:return m(g+"Minutes",1);case n:return m(g+"Seconds",2);case r:return m(g+"Milliseconds",3);default:return this.clone()}},$.endOf=function(t){return this.startOf(t,!1)},$.$set=function(t,e){var s,d=b.p(t),u="set"+(this.$u?"UTC":""),f=(s={},s[o]=u+"Date",s[h]=u+"Date",s[c]=u+"Month",s[l]=u+"FullYear",s[a]=u+"Hours",s[n]=u+"Minutes",s[r]=u+"Seconds",s[i]=u+"Milliseconds",s)[d],m=d===o?this.$D+(e-this.$W):e;if(d===c||d===l){var v=this.clone().set(h,1);v.$d[f](m),v.init(),this.$d=v.set(h,Math.min(this.$D,v.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},$.set=function(t,e){return this.clone().$set(t,e)},$.get=function(t){return this[b.p(t)]()},$.add=function(i,u){var h,f=this;i=Number(i);var m=b.p(u),v=function(t){var e=D(f);return b.w(e.date(e.date()+Math.round(t*i)),f)};if(m===c)return this.set(c,this.$M+i);if(m===l)return this.set(l,this.$y+i);if(m===o)return v(1);if(m===d)return v(7);var p=(h={},h[n]=e,h[a]=s,h[r]=t,h)[m]||1,$=this.$d.getTime()+i*p;return b.w($,this)},$.subtract=function(t,e){return this.add(-1*t,e)},$.format=function(t){var e=this,s=this.$locale();if(!this.isValid())return s.invalidDate||f;var i=t||"YYYY-MM-DDTHH:mm:ssZ",r=b.z(this),n=this.$H,a=this.$m,o=this.$M,d=s.weekdays,c=s.months,u=function(t,s,r,n){return t&&(t[s]||t(e,i))||r[s].slice(0,n)},l=function(t){return b.s(n%12||12,t,"0")},h=s.meridiem||function(t,e,s){var i=t<12?"AM":"PM";return s?i.toLowerCase():i},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:b.s(o+1,2,"0"),MMM:u(s.monthsShort,o,c,3),MMMM:u(c,o),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:u(s.weekdaysMin,this.$W,d,2),ddd:u(s.weekdaysShort,this.$W,d,3),dddd:d[this.$W],H:String(n),HH:b.s(n,2,"0"),h:l(1),hh:l(2),a:h(n,a,!0),A:h(n,a,!1),m:String(a),mm:b.s(a,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:r};return i.replace(v,(function(t,e){return e||m[t]||r.replace(":","")}))},$.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},$.diff=function(i,h,f){var m,v=b.p(h),p=D(i),$=(p.utcOffset()-this.utcOffset())*e,g=this-p,y=b.m(this,p);return y=(m={},m[l]=y/12,m[c]=y,m[u]=y/3,m[d]=(g-$)/6048e5,m[o]=(g-$)/864e5,m[a]=g/s,m[n]=g/e,m[r]=g/t,m)[v]||g,f?y:b.a(y)},$.daysInMonth=function(){return this.endOf(c).$D},$.$locale=function(){return _[this.$L]},$.locale=function(t,e){if(!t)return this.$L;var s=this.clone(),i=S(t,e,!0);return i&&(s.$L=i),s},$.clone=function(){return b.w(this.$d,this)},$.toDate=function(){return new Date(this.valueOf())},$.toJSON=function(){return this.isValid()?this.toISOString():null},$.toISOString=function(){return this.$d.toISOString()},$.toString=function(){return this.$d.toUTCString()},p}(),w=M.prototype;return D.prototype=w,[["$ms",i],["$s",r],["$m",n],["$H",a],["$W",o],["$M",c],["$y",l],["$D",h]].forEach((function(t){w[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),D.extend=function(t,e){return t.$i||(t(e,M,D),t.$i=!0),D},D.locale=S,D.isDayjs=C,D.unix=function(t){return D(1e3*t)},D.en=_[y],D.Ls=_,D.p={},D}))}}]);
//# sourceMappingURL=743-legacy.3df46373.js.map