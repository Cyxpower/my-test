"use strict";(self["webpackChunkmuban"]=self["webpackChunkmuban"]||[]).push([[706],{706:function(t,e,o){o.r(e),o.d(e,{default:function(){return u}});var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"safe"},[o("van-nav-bar",{attrs:{title:"安全中心","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),o("div",{staticClass:"bg"}),o("div",{staticClass:"safe-box"},[o("div",{staticClass:"safe-item",on:{click:t.showPopup}},[o("div",{staticClass:"item-text"},[t._v("修改密码")]),o("div",{staticClass:"item-icon"},[o("van-icon",{attrs:{name:"arrow"}})],1)]),o("van-popup",{style:{height:"50%"},attrs:{"close-on-click-overlay":!1,closeable:"",position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("div",{staticClass:"updatePwd-box"},[o("h1",[t._v("修改密码")]),o("div",{staticClass:"updataPwd"},[o("van-field",{attrs:{type:t.showoldPassword?"password":"text",name:"旧密码",label:"旧密码",placeholder:"旧密码（首字符必须为字母）","right-icon":t.showoldPassword?"closed-eye":"eye-o"},on:{"click-right-icon":function(e){return t.changeoldpwdEye()},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.updatePassword.apply(null,arguments)}},model:{value:t.userInfo.oldpwd,callback:function(e){t.$set(t.userInfo,"oldpwd",e)},expression:"userInfo.oldpwd"}}),o("van-field",{attrs:{type:t.shownewPassword?"password":"text",name:"新密码",label:"新密码",placeholder:"新密码（首字符必须为字母）","right-icon":t.shownewPassword?"closed-eye":"eye-o"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.updatePassword.apply(null,arguments)},"click-right-icon":function(e){return t.changenewpwdEye()}},model:{value:t.userInfo.newpwd,callback:function(e){t.$set(t.userInfo,"newpwd",e)},expression:"userInfo.newpwd"}}),o("div",{staticStyle:{margin:"16px","margin-top":"25px"}},[o("van-button",{staticStyle:{color:"white",border:"1px solid gray"},attrs:{round:"",block:"",type:"primary","native-type":"submit"},on:{click:t.updatePassword}},[t._v("修改密码")])],1)],1)])]),o("div",{staticClass:"van-hairline--top"}),o("div",{staticClass:"safe-item",on:{click:t.destroyAccount}},[o("div",{staticClass:"item-text"},[t._v("注销账号")]),o("div",{staticClass:"item-icon"},[o("van-icon",{attrs:{name:"arrow"}})],1)])],1),o("div",{staticClass:"logout",staticStyle:{margin:"16px","margin-top":"200px"}},[o("van-button",{staticStyle:{color:"white",border:"1px solid gray"},attrs:{round:"",block:"",type:"primary","native-type":"submit"},on:{click:t.logout}},[t._v("退出登录")])],1)],1)},a=[],n=(o(4837),o(9146)),r=o(188),l={data(){return{userInfo:{oldpwd:"",newpwd:""},showoldPassword:!0,shownewPassword:!0,show:!1}},methods:{onClickLeft(){this.$router.go(-1)},showPopup(){this.show=!0},changeoldpwdEye(){this.showoldPassword=!this.showoldPassword},changenewpwdEye(){this.shownewPassword=!this.shownewPassword},updatePassword(){let t={oldpwd:{value:this.userInfo.oldpwd,errorMsg:"旧密码由数字字母下划线组合(6-16字符)",reg:/^[A-Za-z]\w{5,15}$/},newpwd:{value:this.userInfo.newpwd,errorMsg:"新密码由数字字母下划线组合(6-16字符)",reg:/^[A-Za-z]\w{5,15}$/}},e=r.$.valid(t);e&&this.axios({method:"post",url:"/updatePassword",data:{appkey:this.appkey,tokenString:localStorage.getItem("_lk"),password:this.userInfo.newpwd,oldPassword:this.userInfo.oldpwd}}).then((t=>{"E001"==t.data.code?((0,n.Z)(t.data.msg),console.log("修改密码成功",t),setTimeout((()=>{localStorage.removeItem("_lk"),this.$router.push({name:"Login"})}),1e3)):(0,n.Z)(t.data.msg)}))},destroyAccount(){this.$dialog.confirm({title:"注销账号",message:"是否确定注销账号，一旦注销无法恢复！"}).then((()=>{this.axios({method:"post",url:"/destroyAccount",data:{appkey:this.appkey,tokenString:localStorage.getItem("_lk")}}).then((t=>{this.$toast("注销账号成功！"),console.log("注销账号成功",t),setTimeout((()=>{localStorage.removeItem("_lk"),this.$router.push({name:"Login"})}),1e3)}))})).catch((()=>{}))},logout(){this.$dialog.confirm({message:"确定退出登录吗？"}).then((()=>{this.axios({method:"post",url:"/logout",params:{appkey:this.appkey,tokenString:localStorage.getItem("_lk")}}).then((t=>{console.log("退出登录成功",t),(0,n.Z)("退出登录成功"),this.$router.push({name:"Login"}),localStorage.removeItem("_lk")})).catch((t=>{console.log(t)}))})).catch((()=>{}))}}},i=l,d=o(3736),c=(0,d.Z)(i,s,a,!1,null,null,null),u=c.exports},188:function(t,e,o){o.d(e,{$:function(){return r}});o(4837);var s=o(9146),a=o(144);a.Z.use(s.Z);class n{constructor(){}valid(t){for(let e in t)if(!t[e].reg.test(t[e].value))return(0,s.Z)(t[e].errorMsg),!1;return!0}}const r=new n}}]);
//# sourceMappingURL=706.6ddf169f.js.map